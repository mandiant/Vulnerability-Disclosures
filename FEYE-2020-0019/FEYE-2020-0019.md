# FEYE-2020-0019
## Description

Tesla/SolarCity's ConnectPort X2e firmware stored cleartext credentials for the local user `python` in compiled Python (“PYC”) files. This password could be used by a malicious user to establish an SSH connection to a X2e device as this user.

## Impact
High - Using the hardcoded credentials, an attacker can connect to any X2e device to extract sensitive information, install a persistence mechanism, escalate privileges, or cause denial of service conditions.

## Exploitability
Medium - An attacker can use the hardcoded credentials to connect to the affected device remotely as the user `python` using SSH. 

## CVE Reference
CVE-2020-9306

## Technical Details
These credentials were hardcoded as part of the firmware and were shared across all X2e devices.

Mandiant determined a ZIP archive containing compiled python files existed on the X2e device. After unpacking the ZIP archive, Mandiant used a python decompiler ro convert the PYC files to PY. After decompiling, Mandiant located a script containing plaintext credentials for the user `python`. Testers confirmed that the password was shared amongst all Tesla/SolarCity Solar Gateways. 

## Resolution
Tesla issued a OTA patch to all affected gateways. 

## Discovery Credits
- Jake Valletta, FireEye Mandiant
- Sam Sabetan, FireEye Mandiant

## Disclosure Timeline

- 29 January 2020 - Issue reported to vendor
- 04 Februrary 2020 - Issue confirmed by Tesla
- 19 February 2020 - CVE issued by Tesla
- 15 May 2020 - Tesla completed patching of all affected devices
- 17 February 2021 - FireEye Mandiant advisory published

## References

- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9306
- https://www.fireeye.com/blog/threat-research/2021/02/solarcity-exploitation-of-x2e-iot-device-part-one.html
- https://www.fireeye.com/blog/threat-research/2021/02/solarcity-exploitation-of-x2e-iot-device-part-two.html